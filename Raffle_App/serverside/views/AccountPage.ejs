<!doctype html> 
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" type="text/css" href="../CSS/LoginPage.css"> 
    <link rel="stylesheet" type="text/css" href="../CSS/AccountPage.css"> 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="../Js/NavBar.js"></script>
    <script src="../Js/LoginPage.js"></script>
    <script src="../Js/AccountPage.js"></script>
    <script src="../Js/FooterLinks.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Amatic+SC:wght@700&display=swap');
        @import url('https://fonts.googleapis.com/css?family=Varela+Round');
    </style>
</head>
<body>
    <header>
        <% include('partials/header'); %>
    </header>

    <div id="LeftBox" class="mainBox">
        <% if (account.AccountType === 'Raffle Participant') { %>
            <% if (raffles.length > 0) { %>
                <% raffles.forEach(function(raffle) { %>
                    <div class="ContainerDetails">
                        <p>Raffle: <%= raffle.name %></p>
                        <p>Prize: <%= raffle.prize %></p>
                        <p>Date of Draw: <%= new Date(raffle.drawDate).toDateString() %></p>
                        <button id="EnterAccountRaffle" class="submit" type="submit">Enter</button>
                    </div>
                <% }); %>
            <% } else { %>
                <p>No raffles available</p>
            <% } %>
        <% } else if (account.AccountType === 'Raffle Holder') { %>
            <div class="ContainerDetails">
                <form action="/createRaffle" method="POST">
                    <input class="createForms"  type="text" name="name" placeholder="Raffle Name (up to 10 chars)" maxlength="10" pattern="[a-zA-Z0-9]{1,10}" required>
                    <input class="createForms" type="text" name="prize" placeholder="Prize (in Â£, up to 10 digits)" pattern="\d{1,10}" required>
                    <input class="createForms"  type="date" name="drawDate" placeholder="Draw Date" required>
                    <button id="CreateRaffle" class="submit" type="submit">Create Raffle</button>
                </form>
                <button id="DisplayRaffles" class="submit" type="button">My Raffles</button>
            </div>
        <% } %>
            
        <!-- Define hidden message divs -->
        <% if (locals.errors) { %>
            <div id="RaffleTaken" class="HintBox" style="visibility: visible;">
            <ul class="taken">
                <% if (errors === "Failed") { %>
                    <li  class="HintList">Error!</li>
                <% } %>  
                    <% if (errors === "Success") { %>
                      <li  class="HintList">Raffle successfully<br>created.</li>
                    <% }  else { %>
                      <li  class="HintList">Failed to create raffle.</li>
                    <% } %>
                </ul>
            </div>
         <% } %>
    </div>


    

    <div id="RightBox" class="mainBox">
        <div id="AccountDetails" class="ContainerDetails">
            <p id="Username"> <%= account.Username %> </p>
            <p>Username: <%= account.Username %></p>
            <p>Email: <%= account.Email %></p>
            <p>Account Type: <%= account.AccountType %></p>
                    <!-- Display different information based on account type -->
        <% if (account.AccountType === 'Raffle Participant') { %>
            <p>Unclaimed Prizes: 0</p>
        <% } else if (account.AccountType === 'Raffle Holder') { %>
            <p>Raffles Held: <%= account.RafflesHeld || 0 %></p>
        <% } %>
        </div>
<!--------------------------- Buttons for account deletion/ recovery ----------------->
    <form action="/logout">
        <button id="LogOut" class="Leave" type="submit">Log out</button>
    </form>
    <button id="Deactivate" class="Leave" type="submit">Delete Account</button> 
        
    </div>
<!----------------------- Message to appear before deleting/ recovering ----------------------------------->
    <div id="WarningScreen" hidden="">
        <div id="WarningMessage">
            <div id="ExitWarning" class="Hint"></div>
            <p id = "WarningTitle" class="warning" ></p>
            <p id = "MessageInfo" class="warning" ></p>
            <form action="/delete">
                <button id="FinalDeactivate" class="Leave" type="submit">Delete</button> 
            </form>
        </div>
    </div>

    <footer>
        <% include('partials/footer'); %>
    </footer>
</body>
</html>
